<div class="mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 hidden" id="edit-item-<%= item.id %>">
  <%= form_with(model: item, url: settlement.gathering_round_item_path(gathering, round, item), method: :patch, class: "space-y-3", data: { controller: "shared-cost" }) do |form| %>
    <div class="grid grid-cols-1 sm:grid-cols-4 gap-3">
      <div class="sm:col-span-2">
        <%= form.text_field :name, required: true,
            class: "w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
      </div>
      <div>
        <%= form.number_field :amount, min: 0, required: true,
            class: "w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
      </div>
      <div>
        <%= form.number_field :quantity, min: 1,
            class: "w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <label class="inline-flex items-center gap-2 cursor-pointer">
        <%= form.check_box :is_shared, class: "h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded focus:ring-blue-500", data: { shared_cost_target: "shared", action: "change->shared-cost#sharedChanged" } %>
        <span class="text-sm text-gray-700 dark:text-gray-300">공통 비용</span>
      </label>
    </div>

    <%# 참석자 태그 %>
    <div>
      <p class="text-xs text-gray-500 dark:text-gray-400 mb-2">참석자 태그</p>
      <div class="flex flex-wrap gap-2">
        <% round.members.each do |member| %>
          <label class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md border cursor-pointer transition-colors duration-200 text-sm
            <%= item.members.include?(member) ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-300 dark:border-blue-600' : 'border-gray-200 dark:border-gray-500 bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-500' %>">
            <input type="checkbox" name="item[member_ids][]" value="<%= member.id %>"
                   <%= "checked" if item.members.include?(member) %>
                   class="h-3.5 w-3.5 text-blue-600 border-gray-300 dark:border-gray-500 bg-white dark:bg-gray-700 rounded focus:ring-blue-500"
                   data-shared-cost-target="member" data-action="change->shared-cost#memberChanged">
            <span class="text-gray-700 dark:text-gray-200"><%= member.name %></span>
          </label>
        <% end %>
      </div>
    </div>

    <div class="flex items-center gap-2">
      <%= form.submit "저장", class: "inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:hover:bg-blue-500 transition-colors duration-200 cursor-pointer" %>
    </div>
  <% end %>
</div>
